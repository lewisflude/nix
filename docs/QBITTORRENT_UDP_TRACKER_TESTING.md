# Testing UDP Trackers After Interface Binding

**Date:** 2025-01-27
**Status:** Interface manually set to `qbittor0` - Ready for testing

## Current Configuration

✅ **Interface binding set:**

- `Session\Interface=qbittor0`
- `Session\InterfaceName=qbittor0`
- Set manually via WebUI (Options > Advanced > Network Interface)

## Testing Steps

### 1. Check Tracker Status in WebUI

1. Open qBittorrent WebUI: `http://192.168.15.1:8080/`
2. Select a torrent with UDP trackers (e.g., bitsearch.to torrents)
3. Go to **Trackers** tab
4. Look for UDP trackers:
   - **Before:** "Device or resource busy" or "timed out"
   - **After:** Should show "Working" or different status

### 2. Force Tracker Reannounce

1. Select the torrent
2. Right-click → **Force reannounce**
3. Wait a few seconds
4. Check tracker status again

### 3. Monitor UDP Connectivity

From the namespace, UDP connectivity to trackers works:

```bash
sudo ip netns exec qbittor nc -vzu tracker.bitsearch.to 1337
# ✅ Should succeed
```

### 4. Check qBittorrent Sockets

```bash
# Check what interface qBittorrent is using
sudo ip netns exec qbittor ss -tunp | grep qbittorrent

# Look for UDP sockets bound to qbittor0 interface
sudo ip netns exec qbittor ss -ulnp | grep qbittorrent | grep qbittor0
```

## Expected Results

### ✅ Success Indicators

- UDP trackers show "Working" status
- No more "Device or resource busy" errors
- UDP tracker announces succeed
- Peers can be discovered via UDP trackers

### ⚠️ Still Failing

- UDP trackers still timeout → May be VPN provider blocking UDP tracker traffic
- Different error messages → Check what the new error is
- TCP trackers work but UDP don't → VPN provider may filter UDP announces

## Troubleshooting

### If UDP Trackers Still Timeout

1. **Check VPN provider:**
   - Some VPN providers block or throttle UDP tracker announces
   - Check VPN provider documentation

2. **Test UDP from namespace:**

   ```bash
   sudo ip netns exec qbittor nc -vzu tracker.bitsearch.to 1337
   ```

   - If this fails, VPN provider may be blocking UDP

3. **Check firewall rules:**

   ```bash
   sudo ip netns exec qbittor iptables -L OUTPUT -n -v | grep -i udp
   ```

4. **Verify interface binding:**
   - Check WebUI: Options > Advanced > Network Interface
   - Should show: `qbittor0` (not "Any interface")

### If Interface Resets

The config file may be regenerated by qBittorrent or NixOS on service restart. To make it permanent:

1. **Rebuild NixOS:**

   ```bash
   sudo nh os switch
   ```

   This applies the configuration change in `qbittorrent-standard.nix`

2. **Or manually set again in WebUI:**
   - Options > Advanced > Network Interface > `qbittor0`
   - qBittorrent will persist this setting

## Notes

- Manual WebUI changes persist in qBittorrent's config file
- NixOS rebuild will also set this automatically (once we rebuild)
- Interface binding ensures ALL traffic goes through VPN, not just routing
- This is more restrictive than namespace routing alone
